# ✅ 懒人包测试清单

使用此清单验证懒人包是否正常工作。

---

## 📋 测试前准备

### 1. 文件完整性检查

确保以下目录和文件存在：

```
✓ runtime/
  ✓ python.exe
  ✓ python311.dll
  ✓ Lib/ (目录)
  ✓ Scripts/ (目录)

✓ node/
  ✓ node.exe
  ✓ npm.cmd
  ✓ node_modules/ (目录)

✓ backend/
  ✓ app/ (目录)
  ✓ requirements.txt
  ✓ run.py

✓ frontend/
  ✓ src/ (目录)
  ✓ package.json
  
✓ 一键启动.bat
✓ start_backend.bat
```

---

## 🧪 功能测试

### 测试 1: 验证Python环境

```batch
# 在项目根目录运行
runtime\python.exe --version
```

**预期输出**：
```
Python 3.11.x
```

---

### 测试 2: 验证Node环境

```batch
# 在项目根目录运行
node\node.exe --version
```

**预期输出**：
```
v18.x.x 或更高版本
```

---

### 测试 3: 验证npm环境

```batch
# 在项目根目录运行
node\npm.cmd --version
```

**预期输出**：
```
9.x.x 或更高版本
```

---

### 测试 4: 验证Python依赖

```batch
# 在项目根目录运行
runtime\python.exe -m pip list
```

**预期输出**：应该包含以下包
```
fastapi
uvicorn
openai
pydantic
...
```

---

### 测试 5: 后端单独测试

```batch
# 双击运行或在命令行执行
start_backend.bat
```

**预期结果**：
- ✅ 打开一个新的命令窗口
- ✅ 显示启动信息
- ✅ 没有报错
- ✅ 显示 "Uvicorn running on http://127.0.0.1:8000"

**验证**：
1. 打开浏览器访问 http://localhost:8000
2. 应该显示类似：`{"message": "原始平原模拟 API", "version": "1.0.0", "status": "running"}`

---

### 测试 6: 完整启动测试

```batch
# 双击运行
一键启动.bat
```

**预期流程**：
```
[1/5] 检查运行环境...
  ✓ 内置Python和Node.js环境检查通过

[2/5] 配置环境变量...
  ✓ 环境变量配置完成

[3/5] 检查前端依赖...
  首次运行：正在安装前端依赖...（2-5分钟）
  或
  ✓ 前端依赖已存在

[4/5] 启动后端服务器...
  ✓ 后端服务已启动

[5/5] 启动前端服务器...
  ✓ 前端服务已启动

✨ 游戏启动成功！
```

**验证点**：
- ✅ 打开2个新窗口（后端 + 前端）
- ✅ 后端窗口显示 "Uvicorn running"
- ✅ 前端窗口显示 "VITE v5.0.x ready"
- ✅ 5秒后浏览器自动打开
- ✅ 网页显示游戏界面
- ✅ 右上角显示"已连接"（绿点）

---

### 测试 7: 游戏功能测试

在浏览器中测试：

#### 7.1 连接状态
- ✅ 右上角显示绿点 "已连接"

#### 7.2 世界生成
- ✅ 地图显示绿色平原
- ✅ 可以看到资源节点（树、石头、浆果丛等）

#### 7.3 NPC显示
- ✅ 可以看到5个NPC角色
- ✅ NPC有名字标签
- ✅ NPC会移动

#### 7.4 事件日志
- ✅ 左侧事件时间线有内容
- ✅ 事件持续更新
- ✅ 可以看到NPC的行动记录

#### 7.5 NPC面板
- ✅ 右侧显示NPC列表
- ✅ 点击NPC可以查看详情
- ✅ 可以看到NPC的技能、背包等信息

#### 7.6 上帝控制台
- ✅ 右下角有 🔮 图标
- ✅ 点击可以打开上帝控制台
- ✅ 可以添加记忆
- ✅ 操作后有反馈提示

---

## 🐛 常见问题排查

### 问题 1: "找不到 runtime\python.exe"

**原因**：文件未完整解压

**解决**：
1. 重新解压游戏压缩包
2. 确保选择了"解压到当前文件夹"而不是"解压到..."
3. 检查是否被杀毒软件隔离

---

### 问题 2: "找不到 node\node.exe"

**原因**：Node.js环境缺失

**解决**：
1. 确认 `node/` 目录存在
2. 确认 `node/node.exe` 存在
3. 重新解压游戏包

---

### 问题 3: 前端依赖安装失败

**错误信息**：`[ERROR] 前端依赖安装失败`

**解决**：
1. 检查磁盘空间（需要至少500MB）
2. 检查防火墙设置
3. 手动安装：
   ```batch
   cd frontend
   ..\node\node.exe ..\node\node_modules\npm\bin\npm-cli.js install
   ```

---

### 问题 4: 端口被占用

**错误信息**：`Address already in use` 或 `端口被占用`

**解决**：
1. 检查是否有其他实例正在运行
2. 关闭占用端口8000或5173的程序
3. 使用任务管理器结束相关进程

---

### 问题 5: 后端启动后立即关闭

**可能原因**：
- Python依赖缺失
- DeepSeek API配置错误
- 端口被占用

**解决**：
1. 查看后端窗口的错误信息（不要关闭）
2. 检查 `backend/.env` 文件
3. 手动运行后端查看详细错误：
   ```batch
   cd backend
   ..\runtime\python.exe run.py
   ```

---

### 问题 6: 前端显示"未连接"

**原因**：后端未启动或连接失败

**解决**：
1. 确认后端窗口正在运行
2. 访问 http://localhost:8000 确认后端正常
3. 刷新前端页面（Ctrl+F5）
4. 检查浏览器控制台（F12）错误信息

---

### 问题 7: 游戏运行缓慢

**可能原因**：
- 电脑性能不足
- 后台程序占用资源
- AI调用延迟

**解决**：
1. 关闭不必要的后台程序
2. 检查CPU和内存占用
3. AI决策需要2-5秒是正常的

---

## 📊 性能指标

### 正常运行指标

| 指标 | 正常范围 | 说明 |
|------|---------|------|
| 后端内存占用 | 150-300MB | 取决于NPC数量 |
| 前端内存占用 | 100-200MB | 浏览器占用 |
| CPU占用 | 5-15% | 空闲时 |
| 启动时间（首次） | 3-5分钟 | 包含依赖安装 |
| 启动时间（后续） | 10-20秒 | 无需安装依赖 |
| 前端FPS | 55-60 | PixiJS渲染 |

---

## ✅ 测试完成检查表

完成所有测试后，勾选：

- [ ] ✅ 测试1: Python环境正常
- [ ] ✅ 测试2: Node环境正常
- [ ] ✅ 测试3: npm环境正常
- [ ] ✅ 测试4: Python依赖齐全
- [ ] ✅ 测试5: 后端单独启动正常
- [ ] ✅ 测试6: 完整启动流程正常
- [ ] ✅ 测试7.1: 连接状态正常
- [ ] ✅ 测试7.2: 世界生成正常
- [ ] ✅ 测试7.3: NPC显示正常
- [ ] ✅ 测试7.4: 事件日志正常
- [ ] ✅ 测试7.5: NPC面板正常
- [ ] ✅ 测试7.6: 上帝控制台正常

---

## 🎉 测试通过！

如果所有测试都通过，恭喜！你的懒人包已经完美运行了！

### 下一步

- 🎮 开始享受游戏
- 📖 查看 [README.md](README.md) 了解更多功能
- 💡 查看 [PORTABLE_GUIDE.md](PORTABLE_GUIDE.md) 了解高级配置
- 🐛 遇到问题查看 [START.md](START.md)

---

## 📝 报告问题

如果测试失败，请提供以下信息：

1. **失败的测试编号**：例如"测试5失败"
2. **错误信息**：复制完整的错误信息
3. **系统信息**：
   - Windows版本
   - 磁盘剩余空间
   - 杀毒软件名称
4. **截图**：如果可能，提供错误截图

---

<div align="center">

**祝测试顺利！** 🧪✨

如有问题，欢迎提交Issue

</div>

